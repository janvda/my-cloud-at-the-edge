
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Jan Van den Audenaerde">
      
      
        <link rel="canonical" href="https://janvda.github.io/my-cloud-at-the-edge/topics/openwrt_router/">
      
      
        <link rel="prev" href="../../sessions/session_2/">
      
      
        <link rel="next" href="../openwrt_access_point/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.8">
    
    
      
        <title>OpenWrt Router - My Cloud at the Edge</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.ded33207.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#my-openwrt-router" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="My Cloud at the Edge" class="md-header__button md-logo" aria-label="My Cloud at the Edge" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            My Cloud at the Edge
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OpenWrt Router
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/janvda/my-cloud-at-the-edge" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    janvda/my-cloud-at-the-edge
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../sessions/session_1/" class="md-tabs__link">
        Sessions
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="./" class="md-tabs__link md-tabs__link--active">
        Topics
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="My Cloud at the Edge" class="md-nav__button md-logo" aria-label="My Cloud at the Edge" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    My Cloud at the Edge
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/janvda/my-cloud-at-the-edge" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    janvda/my-cloud-at-the-edge
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Sessions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Sessions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sessions/session_1/" class="md-nav__link">
        Session 1 (2023-06-27) Intro & Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sessions/session_2/" class="md-nav__link">
        Session 2 (Under Construction)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Topics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          OpenWrt Router
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        OpenWrt Router
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#router-model" class="md-nav__link">
    Router Model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flashed-with-openwrt" class="md-nav__link">
    Flashed with OpenWrt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#location-in-my-home-network" class="md-nav__link">
    Location in my home network
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why" class="md-nav__link">
    Why ?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ignored-ipv6" class="md-nav__link">
    Ignored IPv6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gui-web-interface" class="md-nav__link">
    GUI (web interface)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-line-ssh" class="md-nav__link">
    Command-line (ssh)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-routing-network" class="md-nav__link">
    Configure routing / network
  </a>
  
    <nav class="md-nav" aria-label="Configure routing / network">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configure-networkinterfaces" class="md-nav__link">
    Configure Network&gt;Interfaces
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firewall-configuration" class="md-nav__link">
    Firewall configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-ipv4-routes" class="md-nav__link">
    Configure IPv4-Routes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-wifi" class="md-nav__link">
    Configure WiFi
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-static-leases" class="md-nav__link">
    Configure Static Leases
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-local-domain-lan" class="md-nav__link">
    Configure Local domain .lan
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#issues" class="md-nav__link">
    Issues
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../openwrt_access_point/" class="md-nav__link">
        OpenWrt Access Point
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../openwrt_time_scheduled_access/" class="md-nav__link">
        OpenWrt Time Scheduled Access
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../google_sites/" class="md-nav__link">
        Google Sites
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../raspberry_pi/" class="md-nav__link">
        Raspberry Pi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intel_nuc/" class="md-nav__link">
        Intel NUC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../raspberry_pi_access_point/" class="md-nav__link">
        Raspberry Pi Access Point
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#router-model" class="md-nav__link">
    Router Model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flashed-with-openwrt" class="md-nav__link">
    Flashed with OpenWrt
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#location-in-my-home-network" class="md-nav__link">
    Location in my home network
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why" class="md-nav__link">
    Why ?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ignored-ipv6" class="md-nav__link">
    Ignored IPv6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gui-web-interface" class="md-nav__link">
    GUI (web interface)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-line-ssh" class="md-nav__link">
    Command-line (ssh)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-routing-network" class="md-nav__link">
    Configure routing / network
  </a>
  
    <nav class="md-nav" aria-label="Configure routing / network">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configure-networkinterfaces" class="md-nav__link">
    Configure Network&gt;Interfaces
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firewall-configuration" class="md-nav__link">
    Firewall configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-ipv4-routes" class="md-nav__link">
    Configure IPv4-Routes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-wifi" class="md-nav__link">
    Configure WiFi
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-static-leases" class="md-nav__link">
    Configure Static Leases
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-local-domain-lan" class="md-nav__link">
    Configure Local domain .lan
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#issues" class="md-nav__link">
    Issues
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="my-openwrt-router">My OpenWrt Router</h1>
<h2 id="router-model">Router Model</h2>
<p><strong>Model</strong> : TP-Link Archer C7 Dual Band Gigabit WiFi-router (1300 Mbps (5 GHz) + 450 Mbps (2,4 GHz), 5 Gigabit LAN-port, 1 USB 2.0-port) Black</p>
<p><strong>Price</strong>: 56 â‚¬ (nov 2021)</p>
<p><strong>Memory</strong>: 120 MB</p>
<p><strong>Architecture</strong>: Qualcomm Atheros QCA956X ver 1 rev 0</p>
<p><img alt="TP-Link Archer C7.jpg" src="TP-Link_Archer_C7.jpg" /></p>
<h2 id="flashed-with-openwrt">Flashed with OpenWrt</h2>
<p><strong>Firmware version</strong> : <code>OpenWrt 21.02.0 r16279-5cc0535800 / LuCI openwrt-21.02 branch git-21.231.26241-422c175</code></p>
<p>The <a href="https://openwrt.org/">OpenWrt Project</a> is a Linux operating system targeting embedded devices (typically wireless routers).</p>
<div class="admonition tip">
<p class="admonition-title">Tip: Assure you buy a router that is in the list of <a href="https://openwrt.org/supported_devices">OpenWrt supported devices</a>.</p>
</div>
<h2 id="location-in-my-home-network">Location in my home network</h2>
<p><img alt="My Home Network" src="network.drawio.png" /></p>
<h2 id="why">Why ?</h2>
<ol>
<li>Flashing a router with OpenWrt was on my nerd bucketlist</li>
<li>Learn about routers, networking and OpenWrt</li>
<li>Have full control to configure your home network<ul>
<li>This is especially relevant if your ISP modem doesn't allow to configure all things</li>
</ul>
</li>
<li>Makes it easier to switch to new ISP or new ISP modem (e.g. switch from ADSL to fiber)</li>
<li>Maybe to get better WiFi  (as your are using the WiFi of the OpenWrt Router iso of the ISP modem)</li>
</ol>
<h2 id="configuration">Configuration</h2>
<p>I don't remember everything I did 2 years ago, but a lot of information can be found at:</p>
<ul>
<li><a href="https://openwrt.org/">openwrt.org</a></li>
<li><a href="https://forum.openwrt.org/">openwrt forum</a></li>
</ul>
<details class="danger">
<summary>Think twice before activating any changes that might make your router inaccessible !</summary>
<p>It is of course possible to make changes so that you can't access your OpenWrt router anymore from any device.  In that case it is also not possible to correct the issue without doing a <code>reset</code> and
 start all over.  (It happened me once)</p>
</details>
<div class="admonition tip">
<p class="admonition-title">The configurations described below can also be performed on most routers/ISP modems !</p>
</div>
<h3 id="ignored-ipv6">Ignored IPv6</h3>
<p>I ignored IPv6 configuration.
IPv4 is sufficient for me and I also don't know much about IPv6.</p>
<h3 id="gui-web-interface">GUI (web interface)</h3>
<p>OpenWrt comes with a very nice GUI.
Almost everything can be configured by this GUI.</p>
<div class="admonition example">
<p class="admonition-title"><a href="http://archer7.lan">DEMO OpenWrt GUI (LuCi)</a></p>
</div>
<h3 id="command-line-ssh">Command-line (ssh)</h3>
<p>Besides the GUI it has also a command line interface (<a href="https://openwrt.org/docs/guide-user/base-system/uci">UCI</a>) which can be accessed via SSH.</p>
<details class="example">
<summary>DEMO Access the router via ssh</summary>
<p>2 examples of uci commands : </p>
<ul>
<li><code>uci help</code></li>
<li><code>uci show wireless.radio1</code></li>
</ul>
</details>
<h3 id="configure-routing-network">Configure routing / network</h3>
<p>The main configuration steps (as I remember it) to setup my <code>192.168.2.0/24</code> network</p>
<h4 id="configure-networkinterfaces">Configure Network&gt;Interfaces</h4>
<p><img alt="network interfaces" src="archer7_network_interfaces.png" /></p>
<h4 id="firewall-configuration">Firewall configuration</h4>
<p>Below settings opens firewall in both directions + enables masquerading in both directions.</p>
<ul>
<li>allows to ping from OpenWrt Router LAN to ISP modem LAN</li>
<li>allows to access the internet from OpenWrt Router LAN</li>
<li>doesn't allow to ping OpenWrt Router LAN from ISP modem LAN</li>
<li>allows to access OpenWrt Router via its ISP modem LAN IP address (http://192.168.1.56)</li>
</ul>
<p><img alt="network firewall" src="archer7_network_firewall.png" /></p>
<h4 id="configure-ipv4-routes">Configure IPv4-Routes</h4>
<p>The routes can be configured via menu <code>Status &gt; Routes</code>.  The relevant IPv4 routes are put in a red box.</p>
<p>I think that I didn't configure those routes, by default they were properly setup.</p>
<p><img alt="network IPv4-Routes" src="archer7_network_ipv4_routes.png" /></p>
<h3 id="configure-wifi">Configure WiFi</h3>
<details class="example">
<summary><a href="http://archer7.lan">Show my OpenWrt WiFi Configuration</a></summary>
<p>Show my actual WiFi configuration (menu  Network &gt; Wireless)</p>
</details>
<h3 id="configure-static-leases">Configure Static Leases</h3>
<p>Instead of working with <code>/etc/hosts</code> files and configuring static IP addresses for each device, you can also define static leases (DHCP).  So the DHCP server of the router will automatically assign a static IP address and hostname based on the MAC address.</p>
<p><img alt="network DHCP Static Leases" src="archer7_network_static_leases.png" /></p>
<details class="example">
<summary><a href="http://archer7.lan">DEMO OpenWrt Static Leases configuration</a></summary>
<p>Demo the assignment of a static lease</p>
</details>
<details class="note">
<summary>Some devices (e.g. iphones) change MAC address each time they connect.</summary>
<p>So this approach of static leases only works if the MAC address doesn't change.
Iphones when connecting to wifi network are each time using a different MAC address.  This makes that DHCP can not use the MAC address to assign a specific IP address.
To overcome this issue you must disable this feature for your home wifi.
This can be disabled on your iphone through following steps:</p>
<ol>
<li>Goto Settings &gt; Wi-Fi</li>
<li>click on (i) - information of <code>&lt;your home wifi network&gt;</code></li>
<li>disable the check box <code>Private Wi-Fi Address</code></li>
<li>... and do the same steps for <code>&lt;your home 5G wifi network&gt;</code> if it exists</li>
</ol>
</details>
<h3 id="configure-local-domain-lan">Configure Local domain <code>.lan</code></h3>
<p>The below settings will set the local domain to <code>.lan</code>.  So the full name of the hosts defined by the static leases is <code>&lt;hostname&gt;.lan</code> (e.g. <code>nuc1.lan</code>)</p>
<p><img alt="network DHCP DNS .lan setup" src="archer7_network_dhcp_dns.png" /></p>
<p>Here below a log of <code>hostname</code> and <code>ping nuc1</code> command entered in a terminal window on my mac-book connected to my home network.  The hostname, domain and ip address are all configured in my OpenWrt router (see above).</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>mac-jan:tmp jan$ hostname
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>mac-jan.lan
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>mac-jan:tmp jan$ ping nuc1
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>PING nuc1.lan (192.168.2.11): 56 data bytes
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>64 bytes from 192.168.2.11: icmp_seq=0 ttl=64 time=35.316 ms
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>64 bytes from 192.168.2.11: icmp_seq=1 ttl=64 time=3.348 ms
</span></code></pre></div>
<h2 id="issues">Issues</h2>
<ul>
<li><a href="https://github.com/janvda/my-cloud-at-the-edge/issues/1">#1 Once or twice a day cannot resolve hostname <code>nuc2.lan</code> in docker container</a> - it is not yet clear if this is caused by this setup or not.</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>The outcome of this configuration:</p>
<ul>
<li>I have created my own <code>192.168.2.0/24</code> home network (domain <code>.lan</code>)</li>
<li>All (relevant) devices automatically get a static IPv4 address and a hostname via DHCP</li>
<li>each device in my home network can reach any of the other devices in my home network by just using its hostname (or hostname<code>.lan</code>)</li>
<li>All of this is configured on my OpenWRT router<ul>
<li>so no specific configuration (E.g. <code>/etc/hosts</code>) is needed on any of the devices in my home network.</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">OpenWrt has a ton of features and <a href="https://openwrt.org/packages/start">additional software packages</a> that I didn't use.</p>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.51198bba.min.js"></script>
      
    
  </body>
</html>